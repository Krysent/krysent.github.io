"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4793],{427:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>c,default:()=>m,frontMatter:()=>s,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"JS\u8fdb\u9636","title":"JavaScript\u8fdb\u9636\u9762\u8bd5\u9898","description":"\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d\u7684\u601d\u8def","source":"@site/docs/interview/JS\u8fdb\u9636.mdx","sourceDirName":".","slug":"/JS\u8fdb\u9636","permalink":"/docs/interview/JS\u8fdb\u9636","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"JavaScript\u57fa\u7840\u9762\u8bd5\u9898","permalink":"/docs/interview/JS\u57fa\u7840"}}');var i=r(4848),o=r(8453);const s={},c="JavaScript\u8fdb\u9636\u9762\u8bd5\u9898",l={},a=[{value:"\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d\u7684\u601d\u8def",id:"\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d\u7684\u601d\u8def",level:2},{value:"\u4ee5\u4e0b\u4ee3\u7801\u8f93\u51fa\u7ed3\u679c\uff1f\u6d89\u53ca\u5f02\u6b65\u95ee\u9898",id:"\u4ee5\u4e0b\u4ee3\u7801\u8f93\u51fa\u7ed3\u679c\u6d89\u53ca\u5f02\u6b65\u95ee\u9898",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"javascript\u8fdb\u9636\u9762\u8bd5\u9898",children:"JavaScript\u8fdb\u9636\u9762\u8bd5\u9898"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d\u7684\u601d\u8def",children:"\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d\u7684\u601d\u8def"}),"\n",(0,i.jsx)(e.p,{children:"\u5224\u65ad\u56fe\u7247\u6240\u5728\u4f4d\u7f6e\u662f\u5426\u5728\u53ef\u89c6\u533a\u57df\u5185\uff0c\u56fe\u7247\u79fb\u5230\u53ef\u89c6\u533a\u57df\u5185\u8fdb\u884c\u52a0\u8f7d\uff0c\u63d0\u4f9b\u4e09\u79cd\u5224\u65ad\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"offsetTop < clientHeight + scrollTop"}),"\n",(0,i.jsx)(e.li,{children:"element.getBoundingClientRect().top < clientHeight"}),"\n",(0,i.jsx)(e.li,{children:"IntersectionObserver"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u65b9\u6848\u4e00",":clientHeight","\u3001scrollTop \u548c offsetTop"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u9996\u5148\u7ed9\u56fe\u7247\u4e00\u4e2a\u5360\u4f4d\u8d44\u6e90:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:'\r\n<img src="default.jpg" data-src="http://www.xxx.com/target.jpg" />\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u63a5\u7740\uff0c\u901a\u8fc7\u76d1\u542c scroll \u4e8b\u4ef6\u6765\u5224\u65ad\u56fe\u7247\u662f\u5426\u5230\u8fbe\u89c6\u53e3:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'let img = document.getElementsByTagName("img");\r\nlet num = img.length;\r\nlet count = 0;//\u8ba1\u6570\u5668\uff0c\u4ece\u7b2c\u4e00\u5f20\u56fe\u7247\u5f00\u59cb\u8ba1\r\n\r\nlazyload();//\u9996\u6b21\u52a0\u8f7d\u522b\u5fd8\u4e86\u663e\u793a\u56fe\u7247\r\n\r\nwindow.addEventListener(\'scroll\', lazyload);\r\n\r\nfunction lazyload() {\r\n  let viewHeight = document.documentElement.clientHeight;//\u89c6\u53e3\u9ad8\u5ea6\r\n  let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;//\u6eda\u52a8\u6761\u5377\u53bb\u7684\u9ad8\u5ea6\r\n  for(let i = count; i <num; i++) {\r\n    // \u5143\u7d20\u73b0\u5728\u5df2\u7ecf\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\r\n    if(img[i].offsetTop < scrollHeight + viewHeight) {\r\n      if(img[i].getAttribute("src") !== "default.jpg") continue;\r\n      img[i].src = img[i].getAttribute("data-src");\r\n      count ++;\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u7136\uff0c\u6700\u597d\u5bf9 scroll \u4e8b\u4ef6\u505a\u8282\u6d41\u5904\u7406\uff0c\u4ee5\u514d\u9891\u7e41\u89e6\u53d1:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"// throttle\u51fd\u6570\u6211\u4eec\u4e0a\u8282\u5df2\u7ecf\u5b9e\u73b0\r\nwindow.addEventListener('scroll', throttle(lazyload, 200));\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u65b9\u6848\u4e8c\uff1agetBoundingClientRect"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u73b0\u5728\u6211\u4eec\u7528\u53e6\u5916\u4e00\u79cd\u65b9\u5f0f\u6765\u5224\u65ad\u56fe\u7247\u662f\u5426\u51fa\u73b0\u5728\u4e86\u5f53\u524d\u89c6\u53e3, \u5373 DOM \u5143\u7d20\u7684 getBoundingClientRect API\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0a\u8ff0\u7684 lazyload \u51fd\u6570\u6539\u6210\u4e0b\u9762\u8fd9\u6837:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:'function lazyload() {\r\n  for(let i = count; i <num; i++) {\r\n    // \u5143\u7d20\u73b0\u5728\u5df2\u7ecf\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\r\n    if(img[i].getBoundingClientRect().top < document.documentElement.clientHeight) {\r\n      if(img[i].getAttribute("src") !== "default.jpg") continue;\r\n      img[i].src = img[i].getAttribute("data-src");\r\n      count ++;\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u65b9\u6848\u4e09: IntersectionObserver"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u662f\u6d4f\u89c8\u5668\u5185\u7f6e\u7684\u4e00\u4e2aAPI\uff0c\u5b9e\u73b0\u4e86\u76d1\u542cwindow\u7684scroll\u4e8b\u4ef6\u3001\u5224\u65ad\u662f\u5426\u5728\u89c6\u53e3\u4e2d\u4ee5\u53ca\u8282\u6d41\u4e09\u5927\u529f\u80fd\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:'let img = document.getElementsByTagName("img");\r\n\r\nconst observer = new IntersectionObserver(changes => {\r\n  //changes \u662f\u88ab\u89c2\u5bdf\u7684\u5143\u7d20\u96c6\u5408\r\n  for(let i = 0, len = changes.length; i < len; i++) {\r\n    let change = changes[i];\r\n    // \u901a\u8fc7\u8fd9\u4e2a\u5c5e\u6027\u5224\u65ad\u662f\u5426\u5728\u89c6\u53e3\u4e2d\r\n    if(change.isIntersecting) {\r\n      const imgElement = change.target;\r\n      imgElement.src = imgElement.getAttribute("data-src");\r\n      observer.unobserve(imgElement);\r\n    }\r\n  }\r\n})\r\nArray.from(img).forEach(item => observer.observe(item));\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u6837\u5c31\u5f88\u65b9\u4fbf\u5730\u5b9e\u73b0\u4e86\u56fe\u7247\u61d2\u52a0\u8f7d\uff0c\u5f53\u7136\u8fd9\u4e2aIntersectionObserver\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5176\u4ed6\u8d44\u6e90\u7684\u9884\u52a0\u8f7d\uff0c\u529f\u80fd\u975e\u5e38\u5f3a\u5927\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u4ee5\u4e0b\u4ee3\u7801\u8f93\u51fa\u7ed3\u679c\u6d89\u53ca\u5f02\u6b65\u95ee\u9898",children:"\u4ee5\u4e0b\u4ee3\u7801\u8f93\u51fa\u7ed3\u679c\uff1f\u6d89\u53ca\u5f02\u6b65\u95ee\u9898"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"async function async1() {\r\n    console.log('async1 start');\r\n    await async2();\r\n    console.log('async1 end');\r\n}\r\n\r\nasync function async2() {\r\n    new Promise(function(resolve) {\r\n        console.log('promise1');\r\n        resolve();\r\n        console.log(\"promiseResolve\")\r\n    }).then(function() {\r\n        setTimeout(function() {\r\n            console.log('setTimeout1');\r\n        })\r\n        console.log('promise2');\r\n    });\r\n}\r\n\r\nconsole.log('script start');\r\n\r\nsetTimeout(function() {\r\n    console.log('setTimeout2');\r\n}, 0)\r\n\r\nasync1();\r\n\r\nprocess.nextTick(() => {\r\n    console.log(\"nextTick\");\r\n})\r\n\r\nnew Promise(function(resolve) {\r\n    console.log('promise3');\r\n    resolve();\r\n    setTimeout(() => {\r\n        console.log('setTimeout3')\r\n    })\r\n}).then(function() {\r\n    console.log('promise4');\r\n})\r\n.then(() => console.log('promise5'))\r\n.then(() => console.log('promise6'))\r\n\r\nconsole.log('script end');\r\n\r\n/*\r\nscript start\r\nasync1 start\r\npromise1\r\npromiseResolve\r\npromise3\r\nnextTick // nextTick\u6709\u81ea\u5df1\u7684\u961f\u5217\uff0c\u4f18\u5148\u4e8e\u5176\u5b83\u5fae\u4efb\u52a1\u5148\u6267\u884c\r\npromise2\r\nscript end\r\nasync1 end\r\npromise4\r\npromise5\r\npromise6\r\nsetTimeout2\r\nsetTimeout3\r\nsetTimeout1\r\n*/\n"})})]})}function m(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>s,x:()=>c});var t=r(6540);const i={},o=t.createContext(i);function s(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);